{% extends "base.html" %}

{% block title %}All Hikes - Hike Guide{% endblock %}

{% block head %}
<style>
    .skeleton-pulse { animation: skeleton-fade 1.5s ease-in-out infinite; }
    @keyframes skeleton-fade { 0%,100%{opacity:0.6} 50%{opacity:1} }
</style>
{% endblock %}

{% block content %}
<!-- Header -->
<div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-8">
    <div>
        <h1 class="font-display text-3xl font-extrabold tracking-tight text-gray-900 sm:text-4xl">All Hikes</h1>
        <p class="mt-1 text-sm text-gray-500">Browse trails, plan your next adventure</p>
    </div>
    <div class="flex items-center gap-2">
        <a href="/hikes/map"
           class="inline-flex items-center gap-1.5 rounded-xl bg-white px-4 py-2 text-sm font-semibold text-gray-600 ring-1 ring-sand-200 hover:bg-sand-50 transition-colors">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"/></svg>
            Map
        </a>
        <a href="/hikes/new"
           class="inline-flex items-center gap-2 rounded-xl bg-forest-600 px-5 py-2.5 text-sm font-bold text-white shadow-sm hover:bg-forest-700 transition-colors">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"/></svg>
            Add Hike
        </a>
    </div>
</div>

<!-- Grid -->
<div class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
    {% for hike in hikes %}
    <a href="/hikes/{{ hike.id }}" class="group block bg-white rounded-2xl overflow-hidden ring-1 ring-sand-200 shadow-sm hover:shadow-lg hover:ring-forest-300 transition-all duration-200">
        <!-- Map thumbnail with skeleton -->
        <div class="relative h-40 bg-sand-100 overflow-hidden">
            <!-- Skeleton pulse (shown until image loads) -->
            <div class="skeleton-pulse absolute inset-0 flex flex-col items-center justify-center gap-2">
                <div class="w-10 h-10 rounded-full bg-sand-200 animate-pulse"></div>
                <div class="w-20 h-2 rounded bg-sand-200 animate-pulse"></div>
                <div class="w-14 h-2 rounded bg-sand-200 animate-pulse"></div>
            </div>
            <img src="/hikes/mapy/static-map/{{ hike.id }}" alt="Map preview for {{ hike.title }}"
                 loading="lazy"
                 class="h-40 w-full object-cover transition-opacity duration-300 opacity-0"
                 onload="this.classList.remove('opacity-0'); this.classList.add('opacity-100'); this.previousElementSibling.remove();"
                 onerror="this.previousElementSibling.innerHTML='<svg class=\'w-10 h-10 text-sand-300\' fill=\'none\' viewBox=\'0 0 24 24\' stroke-width=\'1.5\' stroke=\'currentColor\'><path stroke-linecap=\'round\' stroke-linejoin=\'round\' d=\'M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z\'/></svg>'; this.remove();">
            <!-- Difficulty badge -->
            {% if hike.difficulty %}
            <span class="absolute top-3 right-3 inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-bold
                {% if hike.difficulty == 'Easy' %}bg-green-100 text-green-700
                {% elif hike.difficulty == 'Hard' %}bg-red-100 text-red-700
                {% else %}bg-amber-100 text-amber-700{% endif %}
                shadow-sm">
                {{ hike.difficulty }}
            </span>
            {% endif %}
        </div>
        <!-- Card body -->
        <div class="p-5">
            <div class="flex items-start justify-between gap-2">
                <h3 class="font-display font-bold text-lg text-gray-900 group-hover:text-forest-600 transition-colors leading-tight">{{ hike.title }}</h3>
                {% if hike.status == 'Completed' %}
                <span class="flex-shrink-0 inline-flex items-center gap-1 rounded-full bg-forest-100 px-2 py-0.5 text-xs font-semibold text-forest-700">
                    <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5"/></svg>
                    Done
                </span>
                {% else %}
                <span class="flex-shrink-0 inline-flex items-center rounded-full bg-blue-50 px-2 py-0.5 text-xs font-semibold text-blue-600">Planned</span>
                {% endif %}
            </div>
            {% if hike.start_name or hike.end_name %}
            <p class="mt-1 text-xs text-gray-400 truncate">
                {% if hike.start_name %}{{ hike.start_name }}{% endif %}{% if hike.start_name and hike.end_name %} â†’ {% endif %}{% if hike.end_name %}{{ hike.end_name }}{% endif %}
            </p>
            {% endif %}
            <div class="mt-2.5 flex items-center gap-3 text-sm text-gray-500">
                {% if hike.distance %}
                <span class="inline-flex items-center gap-1">
                    <svg class="w-4 h-4 text-forest-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M6.115 5.19l.319 1.913A6 6 0 008.11 10.36L9.75 12l-.387.775c-.217.433-.132.956.21 1.298l1.348 1.348c.21.21.329.497.329.795v1.089c0 .426.24.815.622 1.006l.153.076c.433.217.956.132 1.298-.21l.723-.723a8.7 8.7 0 002.288-4.042 1.087 1.087 0 00-.358-1.099l-1.33-1.108c-.251-.209-.553-.34-.874-.386l-1.532-.256a4 4 0 01-.837-.225L9.38 8.798a.75.75 0 01-.143-1.218l3.028-2.69a.75.75 0 01.587-.208l2.318.231a3.75 3.75 0 002.898-.91L19.5 2.85"/></svg>
                    {{ hike.distance }} km
                </span>
                {% endif %}
                {% if hike.elevation_gain %}
                <span class="inline-flex items-center gap-1">
                    <svg class="w-4 h-4 text-sand-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M2.25 18L9 11.25l4.306 4.307a11.95 11.95 0 015.814-5.519l2.74-1.22m0 0l-5.94-2.28m5.94 2.28l-2.28 5.941"/></svg>
                    {{ hike.elevation_gain }}m
                </span>
                {% endif %}
            </div>
        </div>
    </a>
    {% else %}
    <!-- Empty state -->
    <div class="col-span-full flex flex-col items-center justify-center py-20 text-center">
        <svg class="w-12 h-12 text-sand-300 mb-4" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.503 3.498l4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.24 5.88 3 6.27 3 6.695V19.18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"/></svg>
        <h3 class="font-display font-bold text-lg text-gray-900">No hikes yet</h3>
        <p class="mt-1 text-sm text-gray-500 max-w-sm">Start tracking your adventures by adding your first hike.</p>
        <a href="/hikes/new"
           class="mt-6 inline-flex items-center gap-2 rounded-xl bg-forest-600 px-5 py-2.5 text-sm font-bold text-white shadow-sm hover:bg-forest-700 transition-colors">
            <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"/></svg>
            Add Your First Hike
        </a>
    </div>
    {% endfor %}
</div>
{% endblock %}